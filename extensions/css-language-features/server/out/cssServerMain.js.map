{"version":3,"file":"cssServerMain.js","sourceRoot":"../src","sources":["cssServerMain.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport {\n\tcreateConnection, IConnection, TextDocuments, InitializeParams, InitializeResult, ServerCapabilities, ConfigurationRequest, WorkspaceFolder\n} from 'vscode-languageserver';\nimport URI from 'vscode-uri';\nimport { TextDocument, CompletionList, Position } from 'vscode-languageserver-types';\n\nimport { getCSSLanguageService, getSCSSLanguageService, getLESSLanguageService, LanguageSettings, LanguageService, Stylesheet } from 'vscode-css-languageservice';\nimport { getLanguageModelCache } from './languageModelCache';\nimport { getPathCompletionParticipant } from './pathCompletion';\nimport { formatError, runSafe } from './utils/runner';\nimport { getDocumentContext } from './utils/documentContext';\nimport { getDataProviders } from './customData';\n\nexport interface Settings {\n\tcss: LanguageSettings;\n\tless: LanguageSettings;\n\tscss: LanguageSettings;\n}\n\n// Create a connection for the server.\nconst connection: IConnection = createConnection();\n\nconsole.log = connection.console.log.bind(connection.console);\nconsole.error = connection.console.error.bind(connection.console);\n\nprocess.on('unhandledRejection', (e: any) => {\n\tconnection.console.error(formatError(`Unhandled exception`, e));\n});\n\n// Create a simple text document manager. The text document manager\n// supports full document sync only\nconst documents: TextDocuments = new TextDocuments();\n// Make the text document manager listen on the connection\n// for open, change and close text document events\ndocuments.listen(connection);\n\nconst stylesheets = getLanguageModelCache<Stylesheet>(10, 60, document => getLanguageService(document).parseStylesheet(document));\ndocuments.onDidClose(e => {\n\tstylesheets.onDocumentRemoved(e.document);\n});\nconnection.onShutdown(() => {\n\tstylesheets.dispose();\n});\n\nlet scopedSettingsSupport = false;\nlet foldingRangeLimit = Number.MAX_VALUE;\nlet workspaceFolders: WorkspaceFolder[];\n\nconst languageServices: { [id: string]: LanguageService } = {};\n\n// After the server has started the client sends an initialize request. The server receives\n// in the passed params the rootPath of the workspace plus the client capabilities.\nconnection.onInitialize((params: InitializeParams): InitializeResult => {\n\tworkspaceFolders = (<any>params).workspaceFolders;\n\tif (!Array.isArray(workspaceFolders)) {\n\t\tworkspaceFolders = [];\n\t\tif (params.rootPath) {\n\t\t\tworkspaceFolders.push({ name: '', uri: URI.file(params.rootPath).toString() });\n\t\t}\n\t}\n\n\tconst dataPaths: string[] = params.initializationOptions.dataPaths;\n\tconst customDataProviders = getDataProviders(dataPaths);\n\n\tfunction getClientCapability<T>(name: string, def: T) {\n\t\tconst keys = name.split('.');\n\t\tlet c: any = params.capabilities;\n\t\tfor (let i = 0; c && i < keys.length; i++) {\n\t\t\tif (!c.hasOwnProperty(keys[i])) {\n\t\t\t\treturn def;\n\t\t\t}\n\t\t\tc = c[keys[i]];\n\t\t}\n\t\treturn c;\n\t}\n\tconst snippetSupport = !!getClientCapability('textDocument.completion.completionItem.snippetSupport', false);\n\tscopedSettingsSupport = !!getClientCapability('workspace.configuration', false);\n\tfoldingRangeLimit = getClientCapability('textDocument.foldingRange.rangeLimit', Number.MAX_VALUE);\n\n\tlanguageServices.css = getCSSLanguageService({ customDataProviders });\n\tlanguageServices.scss = getSCSSLanguageService({ customDataProviders });\n\tlanguageServices.less = getLESSLanguageService({ customDataProviders });\n\n\tconst capabilities: ServerCapabilities = {\n\t\t// Tell the client that the server works in FULL text document sync mode\n\t\ttextDocumentSync: documents.syncKind,\n\t\tcompletionProvider: snippetSupport ? { resolveProvider: false, triggerCharacters: ['/'] } : undefined,\n\t\thoverProvider: true,\n\t\tdocumentSymbolProvider: true,\n\t\treferencesProvider: true,\n\t\tdefinitionProvider: true,\n\t\tdocumentHighlightProvider: true,\n\t\tdocumentLinkProvider: {\n\t\t\tresolveProvider: false\n\t\t},\n\t\tcodeActionProvider: true,\n\t\trenameProvider: true,\n\t\tcolorProvider: {},\n\t\tfoldingRangeProvider: true\n\t};\n\treturn { capabilities };\n});\n\nfunction getLanguageService(document: TextDocument) {\n\tlet service = languageServices[document.languageId];\n\tif (!service) {\n\t\tconnection.console.log('Document type is ' + document.languageId + ', using css instead.');\n\t\tservice = languageServices['css'];\n\t}\n\treturn service;\n}\n\nlet documentSettings: { [key: string]: Thenable<LanguageSettings | undefined> } = {};\n// remove document settings on close\ndocuments.onDidClose(e => {\n\tdelete documentSettings[e.document.uri];\n});\nfunction getDocumentSettings(textDocument: TextDocument): Thenable<LanguageSettings | undefined> {\n\tif (scopedSettingsSupport) {\n\t\tlet promise = documentSettings[textDocument.uri];\n\t\tif (!promise) {\n\t\t\tconst configRequestParam = { items: [{ scopeUri: textDocument.uri, section: textDocument.languageId }] };\n\t\t\tpromise = connection.sendRequest(ConfigurationRequest.type, configRequestParam).then(s => s[0]);\n\t\t\tdocumentSettings[textDocument.uri] = promise;\n\t\t}\n\t\treturn promise;\n\t}\n\treturn Promise.resolve(undefined);\n}\n\n// The settings have changed. Is send on server activation as well.\nconnection.onDidChangeConfiguration(change => {\n\tupdateConfiguration(<Settings>change.settings);\n});\n\nfunction updateConfiguration(settings: Settings) {\n\tfor (const languageId in languageServices) {\n\t\tlanguageServices[languageId].configure((settings as any)[languageId]);\n\t}\n\t// reset all document settings\n\tdocumentSettings = {};\n\t// Revalidate any open text documents\n\tdocuments.all().forEach(triggerValidation);\n}\n\nconst pendingValidationRequests: { [uri: string]: NodeJS.Timer } = {};\nconst validationDelayMs = 500;\n\n// The content of a text document has changed. This event is emitted\n// when the text document first opened or when its content has changed.\ndocuments.onDidChangeContent(change => {\n\ttriggerValidation(change.document);\n});\n\n// a document has closed: clear all diagnostics\ndocuments.onDidClose(event => {\n\tcleanPendingValidation(event.document);\n\tconnection.sendDiagnostics({ uri: event.document.uri, diagnostics: [] });\n});\n\nfunction cleanPendingValidation(textDocument: TextDocument): void {\n\tconst request = pendingValidationRequests[textDocument.uri];\n\tif (request) {\n\t\tclearTimeout(request);\n\t\tdelete pendingValidationRequests[textDocument.uri];\n\t}\n}\n\nfunction triggerValidation(textDocument: TextDocument): void {\n\tcleanPendingValidation(textDocument);\n\tpendingValidationRequests[textDocument.uri] = setTimeout(() => {\n\t\tdelete pendingValidationRequests[textDocument.uri];\n\t\tvalidateTextDocument(textDocument);\n\t}, validationDelayMs);\n}\n\nfunction validateTextDocument(textDocument: TextDocument): void {\n\tconst settingsPromise = getDocumentSettings(textDocument);\n\tsettingsPromise.then(settings => {\n\t\tconst stylesheet = stylesheets.get(textDocument);\n\t\tconst diagnostics = getLanguageService(textDocument).doValidation(textDocument, stylesheet, settings);\n\t\t// Send the computed diagnostics to VSCode.\n\t\tconnection.sendDiagnostics({ uri: textDocument.uri, diagnostics });\n\t}, e => {\n\t\tconnection.console.error(formatError(`Error while validating ${textDocument.uri}`, e));\n\t});\n}\n\nconnection.onCompletion((textDocumentPosition, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(textDocumentPosition.textDocument.uri);\n\t\tif (!document) {\n\t\t\treturn null;\n\t\t}\n\t\tconst cssLS = getLanguageService(document);\n\t\tconst pathCompletionList: CompletionList = {\n\t\t\tisIncomplete: false,\n\t\t\titems: []\n\t\t};\n\t\tcssLS.setCompletionParticipants([getPathCompletionParticipant(document, workspaceFolders, pathCompletionList)]);\n\t\tconst result = cssLS.doComplete(document, textDocumentPosition.position, stylesheets.get(document));\n\t\treturn {\n\t\t\tisIncomplete: pathCompletionList.isIncomplete,\n\t\t\titems: [...pathCompletionList.items, ...result.items]\n\t\t};\n\t}, null, `Error while computing completions for ${textDocumentPosition.textDocument.uri}`, token);\n});\n\nconnection.onHover((textDocumentPosition, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(textDocumentPosition.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst styleSheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).doHover(document, textDocumentPosition.position, styleSheet);\n\t\t}\n\t\treturn null;\n\t}, null, `Error while computing hover for ${textDocumentPosition.textDocument.uri}`, token);\n});\n\nconnection.onDocumentSymbol((documentSymbolParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(documentSymbolParams.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findDocumentSymbols(document, stylesheet);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing document symbols for ${documentSymbolParams.textDocument.uri}`, token);\n});\n\nconnection.onDefinition((documentDefinitionParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(documentDefinitionParams.textDocument.uri);\n\t\tif (document) {\n\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findDefinition(document, documentDefinitionParams.position, stylesheet);\n\t\t}\n\t\treturn null;\n\t}, null, `Error while computing definitions for ${documentDefinitionParams.textDocument.uri}`, token);\n});\n\nconnection.onDocumentHighlight((documentHighlightParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(documentHighlightParams.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findDocumentHighlights(document, documentHighlightParams.position, stylesheet);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing document highlights for ${documentHighlightParams.textDocument.uri}`, token);\n});\n\n\nconnection.onDocumentLinks((documentLinkParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(documentLinkParams.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst documentContext = getDocumentContext(document.uri, workspaceFolders);\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findDocumentLinks(document, stylesheet, documentContext);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing document links for ${documentLinkParams.textDocument.uri}`, token);\n});\n\n\nconnection.onReferences((referenceParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(referenceParams.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findReferences(document, referenceParams.position, stylesheet);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing references for ${referenceParams.textDocument.uri}`, token);\n});\n\nconnection.onCodeAction((codeActionParams, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(codeActionParams.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).doCodeActions(document, codeActionParams.range, codeActionParams.context, stylesheet);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing code actions for ${codeActionParams.textDocument.uri}`, token);\n});\n\nconnection.onDocumentColor((params, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).findDocumentColors(document, stylesheet);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing document colors for ${params.textDocument.uri}`, token);\n});\n\nconnection.onColorPresentation((params, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).getColorPresentations(document, stylesheet, params.color, params.range);\n\t\t}\n\t\treturn [];\n\t}, [], `Error while computing color presentations for ${params.textDocument.uri}`, token);\n});\n\nconnection.onRenameRequest((renameParameters, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(renameParameters.textDocument.uri);\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).doRename(document, renameParameters.position, renameParameters.newName, stylesheet);\n\t\t}\n\t\treturn null;\n\t}, null, `Error while computing renames for ${renameParameters.textDocument.uri}`, token);\n});\n\nconnection.onFoldingRanges((params, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tif (document) {\n\t\t\treturn getLanguageService(document).getFoldingRanges(document, { rangeLimit: foldingRangeLimit });\n\t\t}\n\t\treturn null;\n\t}, null, `Error while computing folding ranges for ${params.textDocument.uri}`, token);\n});\n\nconnection.onRequest('$/textDocument/selectionRanges', async (params, token) => {\n\treturn runSafe(() => {\n\t\tconst document = documents.get(params.textDocument.uri);\n\t\tconst positions: Position[] = params.positions;\n\n\t\tif (document) {\n\t\t\tconst stylesheet = stylesheets.get(document);\n\t\t\treturn getLanguageService(document).getSelectionRanges(document, positions, stylesheet);\n\t\t}\n\t\treturn Promise.resolve(null);\n\t}, null, `Error while computing selection ranges for ${params.textDocument.uri}`, token);\n});\n\n\n// Listen on the connection\nconnection.listen();"]}